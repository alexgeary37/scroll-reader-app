(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{173:function(e,t,n){},174:function(e,t,n){},203:function(e,t,n){"use strict";n.r(t);var i=n(0),s=n.n(i),c=n(65),r=n.n(c),a=(n(173),n(15)),o=(n(174),n(60)),l=n(5),u=n(224),d=n(47),j=n(204),f=n(226),b=n(1),h=function(e){var t=e.isOpen,n=e.answerYes,i=e.answerNo;return Object(b.jsxs)(f.a,{size:"tiny",open:t,style:{textAlign:"center",padding:10},children:[Object(b.jsxs)(f.a.Header,{as:"h4",children:["Are you sure you want to delete this text?",Object(b.jsx)("br",{})]}),Object(b.jsx)(j.a,{primary:!0,content:"Yes",onClick:n}),Object(b.jsx)(j.a,{content:"No",onClick:i})]})},O=n(231),x=n(222),p=n(225),m=n(218),g=n(216),v=n(9),y=n.n(v),S=n(229),I=/[\s\r\n,]+/,D=function(e,t){return"speed"===e?t.fileNumber===t.template.speedTest.texts.length-1:"scroll"===e?t.fileNumber===t.template.scrollTexts.length-1:void 0},w=function(){window.scrollTo({top:0,behavior:"smooth"})},k=function(e,t){var n=t.sessionID,i=new Date;y.a.put("http://localhost:3001/addViewportChange",{id:n,width:window.innerWidth,height:window.innerHeight,time:i}).catch((function(e){console.error("Error updating readingSession.viewportDimensions:",e)}))},T=function(e,t){var n={yPos:t,time:new Date,sessionID:e.sessionID,textNumber:e.fileNumber};e.setScrollPosEntries([].concat(Object(o.a)(e.scrollPosEntries),[n]))},C=n(230),N=function(e){var t,n=e.fileID,s=e.answerRegion,c=e.selectAnswer,r=Object(i.useState)([]),a=Object(l.a)(r,2),o=a[0],u=a[1];Object(i.useEffect)((function(){d()}),[n]);var d=function(){y.a.get("http://localhost:3001/getTextFile",{params:{_id:n}}).then((function(e){u(e.data.text.split(I))})).catch((function(e){console.error("Error fetching text in ScrollText:",e)}))},j=function(e){var t=Math.min(s.startIndex,s.endIndex),n=Math.max(s.startIndex,s.endIndex);return t<=e&&e<=n&&n>0?"yellow":"white"};return Object(b.jsx)(C.a,{style:{overflow:"auto",maxHeight:"65vh"},children:Object(b.jsx)("p",{children:o.map((function(e,n){return Object(b.jsx)("span",{onMouseDown:function(){return t=n},onMouseUp:function(){return function(e){t!==e&&c(Math.min(t,e),Math.max(t,e))}(n)},style:{backgroundColor:j(n)},children:e+" "},Object(S.a)())}))})})},F=function(e){var t=e.isOpen,n=e.fileID,s=e.format,c=e.addQuestion,r=e.close,a=Object(i.useState)(""),o=Object(l.a)(a,2),u=o[0],d=o[1],h=Object(i.useState)({startIndex:0,endIndex:0}),O=Object(l.a)(h,2),x=O[0],p=O[1],m=Object(i.useState)(!1),v=Object(l.a)(m,2),y=v[0],S=v[1],I=Object(i.useState)(!1),D=Object(l.a)(I,2),w=D[0],k=D[1],T=Object(i.useState)(!1),C=Object(l.a)(T,2),F=C[0],E=C[1],q=function(e){S(!1),d(e.target.value)},A=function(e,t){E(!1),p({startIndex:e,endIndex:t})},_=function(){""!==u?"inline"!==s||0!==x.startIndex||0!==x.endIndex?(d(""),k(!1),c(u,x),p({startIndex:0,endIndex:0}),r()):E(!0):S(!0)},Q=function(){d(""),p({startIndex:0,endIndex:0}),k(!1),E(!1),r()},H=function(){if(F)return Object(b.jsx)("label",{style:{padding:10,color:"red"},children:"Please select an answer region for this question!"})},R=function(){if("inline"===s)return Object(b.jsxs)("div",{children:[Object(b.jsx)(j.a,{positive:!0,content:"Select Answer Region",onClick:function(){return k(!w)}}),P()]})},P=function(){if(w)return Object(b.jsx)("span",{style:{padding:10,color:"blue"},children:"Answer Region: words [".concat(x.startIndex," - ").concat(x.endIndex,"]")})};return Object(b.jsxs)(f.a,{open:t,size:"small",style:{padding:10},children:[function(){if(w)return Object(b.jsx)(N,{fileID:n,answerRegion:x,selectAnswer:A})}(),Object(b.jsxs)("div",{children:[H(),Object(b.jsx)(g.a,{style:{marginBottom:10},error:y,autoFocus:!0,type:"text",fluid:!0,placeholder:"Type a question for this text here...",onChange:q}),R(),Object(b.jsxs)("div",{style:{position:"absolute",right:10,bottom:10},children:[Object(b.jsx)(j.a,{content:"Cancel",onClick:Q}),Object(b.jsx)(j.a,{primary:!0,content:"Add Question",onClick:_})]})]})]})},E=function(e){var t=e.isOpen,n=e.fileID,s=e.questions,c=e.format,r=e.updateFileQuestions,a=e.removeQuestion,o=e.close,d=Object(i.useState)(!1),h=Object(l.a)(d,2),g=h[0],v=h[1],S=Object(i.useState)(c),I=Object(l.a)(S,2),D=I[0],w=I[1],k=Object(i.useState)([]),T=Object(l.a)(k,2),C=T[0],N=T[1];Object(i.useEffect)((function(){w(c)}),[c]),Object(i.useEffect)((function(){t&&E()}),[t]);var E=function(){y.a.get("http://localhost:3001/getUsedQuestions").then((function(e){N(e.data)})).catch((function(e){console.error("Error fetching used questions:",e)}))};return Object(b.jsxs)(f.a,{style:{padding:10},open:t,children:[Object(b.jsx)(O.a,{as:"h4",content:"Questions"}),Object(b.jsx)("div",{children:Object(b.jsx)(x.a,{children:Object(b.jsxs)("div",{className:"grouped fields",children:[Object(b.jsx)(x.a.Field,{children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",disabled:""!==c,checked:"comprehension"===D,onChange:function(){return w("comprehension")}}),Object(b.jsx)("label",{children:"Comprehension"})]})}),Object(b.jsx)(x.a.Field,{children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",disabled:""!==c,checked:"inline"===D,onChange:function(){return w("inline")}}),Object(b.jsx)("label",{children:"Inline"})]})})]})})}),Object(b.jsx)(j.a,{positive:!0,disabled:""===D,content:"Add Question",onClick:function(){return v(!0)}}),Object(b.jsx)(p.a,{ordered:!0,divided:!0,relaxed:!0,children:s.map((function(e){return Object(b.jsx)(u.a,{children:Object(b.jsxs)("div",{className:"wrapper",children:[Object(b.jsx)(u.a.Description,{content:e.question}),Object(b.jsx)(u.a.Description,{content:"Word Index Answer Region: [".concat(e.answerRegion.startIndex,"...").concat(e.answerRegion.endIndex,"]")}),Object(b.jsx)(j.a,{floated:"right",disabled:C.includes(e._id),content:"Remove",onClick:function(){return a(e)}})]})},e._id)}))}),Object(b.jsx)(m.a,{}),Object(b.jsx)(j.a,{floated:"right",content:"Close",onClick:o}),Object(b.jsx)(F,{isOpen:g,fileID:n,format:D,addQuestion:function(e,t){y.a.put("http://localhost:3001/addTextFileQuestion",{id:n,question:e.trim(),answerRegion:t,questionFormat:D}).then((function(e){var t=e.data.questions.at(-1);r(t,D)})).catch((function(e){console.error("Error updating file.questions and file.questionFormat:",e)}))},close:function(){return v(!1)}})]})},q=function(e){var t=e.isOpen,n=e.addStyle,s=e.close,c=Object(i.useState)(""),r=Object(l.a)(c,2),a=r[0],o=r[1],u=Object(i.useState)(-1),d=Object(l.a)(u,2),h=d[0],O=d[1],x=Object(i.useState)(-1),p=Object(l.a)(x,2),m=p[0],v=p[1],y=Object(i.useState)(!1),S=Object(l.a)(y,2),I=S[0],D=S[1],w=Object(i.useState)(!1),k=Object(l.a)(w,2),T=k[0],C=k[1],N=Object(i.useState)(!1),F=Object(l.a)(N,2),E=F[0],q=F[1],A=function(e){D(!1),o(e.target.value)},_=function(e){C(!1),O(e.target.value)},Q=function(e){q(!1),v(e.target.value)},H=function(){if(!function(){var e=!1;return""===a&&(D(!0),e=!0),-1===h&&(C(!0),e=!0),-1===m&&(q(!0),e=!0),e}()){var e={fontFamily:a.trim(),fontSize:h,lineHeight:m};n(e),o(""),O(-1),v(-1),s()}},R=function(){o(""),O(-1),v(-1),D(!1),C(!1),q(!1),s()};return Object(b.jsx)(f.a,{open:t,size:"tiny",style:{padding:10},children:Object(b.jsxs)("div",{children:[Object(b.jsx)(g.a,{style:{marginBottom:10},error:I,autoFocus:!0,type:"text",fluid:!0,placeholder:"Type a font family here...",onChange:A}),Object(b.jsx)(g.a,{style:{marginBottom:10},error:T,type:"Number",placeholder:"Size (pixels)",onChange:_}),Object(b.jsx)(g.a,{style:{marginBottom:10},error:E,type:"Number",placeholder:"Line height (pixels)",onChange:Q}),Object(b.jsxs)("div",{style:{position:"absolute",right:10,bottom:10},children:[Object(b.jsx)(j.a,{content:"Cancel",onClick:R}),Object(b.jsx)(j.a,{primary:!0,content:"Add Style",onClick:H})]})]})})},A=function(e){var t=e.isOpen,n=e.fileID,s=e.styles,c=e.updateFileStyles,r=e.removeStyle,a=e.close,o=Object(i.useState)(!1),d=Object(l.a)(o,2),h=d[0],x=d[1],g=Object(i.useState)([]),v=Object(l.a)(g,2),S=v[0],I=v[1];Object(i.useEffect)((function(){t&&D()}),[t]);var D=function(){y.a.get("http://localhost:3001/getUsedStyles").then((function(e){I(e.data)})).catch((function(e){console.error("Error fetching used styles:",e)}))};return Object(b.jsxs)(f.a,{style:{padding:10},open:t,children:[Object(b.jsx)(O.a,{as:"h4",content:"Styles"}),Object(b.jsx)(j.a,{positive:!0,content:"Add Style",onClick:function(){return x(!0)}}),Object(b.jsx)(p.a,{ordered:!0,divided:!0,relaxed:!0,children:s.map((function(e){return Object(b.jsx)(u.a,{children:Object(b.jsxs)("div",{className:"wrapper",children:[Object(b.jsx)(u.a.Description,{content:"font-family: ".concat(e.fontFamily)}),Object(b.jsx)(u.a.Description,{content:"font-size: ".concat(e.fontSize)}),Object(b.jsx)(u.a.Description,{content:"line-height: ".concat(e.lineHeight)}),Object(b.jsx)(j.a,{floated:"right",disabled:S.includes(e._id)||s.length<2,content:"Remove",onClick:function(){return r(e)}})]})},e._id)}))}),Object(b.jsx)(m.a,{}),Object(b.jsx)(j.a,{floated:"right",content:"Close",onClick:a}),Object(b.jsx)(q,{isOpen:h,fileID:n,addStyle:function(e){y.a.put("http://localhost:3001/addTextFileStyle",{id:n,style:e}).then((function(e){var t=e.data.styles.at(-1);c(t)})).catch((function(e){console.error("Error updating file.styles:",e)}))},close:function(){return x(!1)}})]})},_=function(e){var t=e.isOpen,n=e.fileID,s=e.close,c=Object(i.useState)(""),r=Object(l.a)(c,2),a=r[0],o=r[1];Object(i.useEffect)((function(){t&&y.a.get("http://localhost:3001/getTextFile",{params:{_id:n}}).then((function(e){o(e.data.text)})).catch((function(e){console.error("Error fetching text in TextFileTextView:",e)}))}),[t]);return Object(b.jsxs)(f.a,{style:{padding:10},open:t,children:[Object(b.jsx)(C.a,{style:{overflow:"auto",maxHeight:"65vh"},children:Object(b.jsx)("p",{children:a})}),Object(b.jsx)(j.a,{floated:"right",content:"Close",onClick:function(){o(""),s()}})]})},Q=function(e){var t=e.file,n=e.usedInTemplate,s=(e.usedAsScrollText,e.updateFileQuestions),c=e.removeQuestion,r=e.updateFileStyles,a=e.removeStyle,o=e.deleteFile,f=Object(i.useState)(!1),O=Object(l.a)(f,2),x=O[0],p=O[1],m=Object(i.useState)(!1),g=Object(l.a)(m,2),v=g[0],y=g[1],S=Object(i.useState)(!1),I=Object(l.a)(S,2),D=I[0],w=I[1],k=Object(i.useState)(!1),T=Object(l.a)(k,2),C=T[0],N=T[1];return Object(b.jsxs)(u.a,{children:[Object(b.jsx)(d.a,{size:"large",name:"file outline"}),Object(b.jsxs)(u.a.Content,{children:[Object(b.jsxs)("div",{className:"wrapper",children:[Object(b.jsxs)("div",{children:[Object(b.jsx)(u.a.Header,{as:"h4",style:{margin:5},content:t.name}),Object(b.jsx)(u.a.Description,{content:"Uploaded: ".concat(t.uploadedAt)}),Object(b.jsx)(u.a.Description,{content:"Question Format: ".concat(t.questionFormat)})]}),Object(b.jsxs)("div",{className:"ui vertical buttons",children:[Object(b.jsx)(j.a,{content:"Questions",onClick:function(){return p(!0)}}),Object(b.jsx)(j.a,{content:"Styles",onClick:function(){return y(!0)}})]}),Object(b.jsxs)("div",{className:"ui vertical buttons",style:{marginLeft:5},children:[Object(b.jsx)(j.a,{content:"View Text",onClick:function(){return w(!0)}}),Object(b.jsx)(j.a,{disabled:n,content:"Delete",onClick:function(){return N(!0)}})]})]}),Object(b.jsx)(E,{isOpen:x,fileID:t.key,questions:t.questions,format:t.questionFormat,updateFileQuestions:s,removeQuestion:c,close:function(){return p(!1)}}),Object(b.jsx)(A,{isOpen:v,fileID:t.value,styles:t.styles,updateFileStyles:r,removeStyle:a,close:function(){return y(!1)}}),Object(b.jsx)(_,{isOpen:D,fileID:t.value,close:function(){return w(!1)}}),Object(b.jsx)(h,{isOpen:C,answerYes:o,answerNo:function(){return N(!1)}})]})]})},H=n(219),R=n(232),P=function(e){var t=e.isOpen,n=e.template,i=e.textFiles,s=e.close,c=function(e){return"font-family: ".concat(i.find((function(t){return t.value===e.fileID})).styles.find((function(t){return t._id===e.styleID})).fontFamily,", font-size: ").concat(i.find((function(t){return t.value===e.fileID})).styles.find((function(t){return t._id===e.styleID})).fontSize,", line-height: ").concat(i.find((function(t){return t.value===e.fileID})).styles.find((function(t){return t._id===e.styleID})).lineHeight)};return Object(b.jsxs)(f.a,{open:t,style:{height:"70vh",padding:10},children:[Object(b.jsx)(O.a,{as:"h1",content:n.name}),Object(b.jsx)(C.a,{basic:!0,style:{overflow:"auto",maxHeight:"75%"},children:Object(b.jsx)(u.a,{children:Object(b.jsxs)(u.a.Content,{children:[Object(b.jsx)(p.a,{children:Object(b.jsx)(u.a,{children:Object(b.jsx)(u.a.Description,{content:"Created: ".concat(n.createdAt)})})}),Object(b.jsxs)("div",{children:[Object(b.jsx)(u.a.Header,{as:"h3",content:"Speedtest"}),Object(b.jsxs)(p.a,{children:[Object(b.jsx)(u.a,{children:Object(b.jsx)(u.a.Description,{children:"Instructions: ".concat(n.speedTest.instructions)})}),Object(b.jsxs)(u.a,{children:[Object(b.jsx)(u.a.Header,{as:"h4",style:{margin:5},content:"Texts:"}),Object(b.jsx)(p.a,{style:{marginLeft:20},divided:!0,relaxed:!0,children:n.speedTest.texts.map((function(e){return Object(b.jsx)(u.a,{children:Object(b.jsxs)(u.a.Content,{children:[Object(b.jsx)(u.a.Header,{as:"h5",content:"".concat(n.speedTest.texts.indexOf(e)+1,". ").concat(e.name)}),Object(b.jsx)(u.a.Description,{as:"h5",style:{marginTop:5,marginBottom:0},content:"Style"}),Object(b.jsx)(u.a.Description,{style:{marginLeft:20},content:c(e)})]})},e.fileID)}))})]})]})]}),Object(b.jsx)(m.a,{}),Object(b.jsxs)("div",{children:[Object(b.jsx)(u.a.Header,{as:"h3",content:"ScrollTexts"}),Object(b.jsx)(p.a,{style:{marginLeft:20},divided:!0,relaxed:!0,children:n.scrollTexts.map((function(e){return Object(b.jsx)(u.a,{children:Object(b.jsxs)(u.a.Content,{children:[Object(b.jsx)(u.a.Header,{as:"h5",content:"".concat(n.scrollTexts.indexOf(e)+1,". ").concat(e.name)}),Object(b.jsx)(u.a.Description,{style:{marginTop:5},content:"Instructions: ".concat(e.instructions.main)}),Object(b.jsx)(u.a.Description,{content:!0===JSON.parse(e.instructions.hasFamiliarityQuestion)?"Ask familiarity: Yes":"Ask familiarity: No"}),Object(b.jsx)(u.a.Description,{content:!0===JSON.parse(e.instructions.hasInterestQuestion)?"Ask interest: Yes":"Ask interest: No"}),Object(b.jsx)(u.a.Description,{as:"h5",style:{marginTop:5,marginBottom:0},content:"Style"}),Object(b.jsx)(u.a.Description,{style:{marginLeft:20},content:c(e)}),Object(b.jsx)(u.a.Description,{as:"h5",style:{marginTop:5,marginBottom:0},content:"Questions:"}),Object(b.jsx)(p.a,{style:{marginLeft:20},children:e.questionIDs.map((function(t){return Object(b.jsx)(u.a,{children:Object(b.jsx)(u.a.Content,{children:Object(b.jsx)(u.a.Description,{content:"".concat(e.questionIDs.indexOf(t)+1,". ").concat(i.find((function(t){return t.value===e.fileID})).questions.find((function(e){return e._id===t})).question)})})},t)}))})]})},e.fileID)}))})]})]})})}),Object(b.jsx)(j.a,{style:{position:"absolute",right:10,bottom:10},content:"Close",onClick:s})]})},z=function(e){var t=e.isOpen,n=e.answerYes,i=e.answerNo;return Object(b.jsxs)(f.a,{size:"tiny",open:t,style:{textAlign:"center",padding:10},children:[Object(b.jsxs)(f.a.Header,{as:"h4",children:["Are you sure you want to delete this template?",Object(b.jsx)("br",{})]}),Object(b.jsx)(j.a,{primary:!0,content:"Yes",onClick:n}),Object(b.jsx)(j.a,{content:"No",onClick:i})]})},J=function(e){var t=e.template,n=e.textFiles,s=e.deleteTemplate,c=Object(i.useState)(!1),r=Object(l.a)(c,2),a=r[0],o=r[1],d=Object(i.useState)(!1),f=Object(l.a)(d,2),h=f[0],O=f[1];return Object(b.jsx)(u.a,{children:Object(b.jsxs)(u.a.Content,{children:[Object(b.jsxs)("div",{onClick:function(){return o(!0)},children:[Object(b.jsx)(u.a.Header,{as:"h3",style:{margin:5},content:t.name}),Object(b.jsx)(u.a.Description,{as:"h5",style:{margin:5},content:"Speedtest texts:"}),Object(b.jsx)(p.a,{style:{marginLeft:20},horizontal:!0,divided:!0,children:t.speedTest.texts.map((function(e){return Object(b.jsx)(u.a,{children:Object(b.jsx)(u.a.Content,{children:Object(b.jsx)(u.a.Description,{content:"".concat(t.speedTest.texts.indexOf(e)+1,". ").concat(e.name)})})},e.fileID)}))}),Object(b.jsx)(u.a.Description,{as:"h5",style:{margin:5},content:"Scrolltest texts:"}),Object(b.jsx)(p.a,{style:{marginLeft:20},horizontal:!0,divided:!0,children:t.scrollTexts.map((function(e){return Object(b.jsx)(u.a,{children:Object(b.jsx)(u.a.Content,{children:Object(b.jsx)(u.a.Description,{content:"".concat(t.scrollTexts.indexOf(e)+1,". ").concat(e.name)})})},e.fileID)}))})]}),Object(b.jsxs)("div",{className:"wrapper",children:[Object(b.jsx)(u.a.Description,{style:{margin:5},content:"URL: ".concat(t.url)}),Object(b.jsx)(j.a,{content:"Copy URL",onClick:function(){return navigator.clipboard.writeText(t.url)}}),Object(b.jsx)(j.a,{content:"Delete",onClick:function(){return O(!0)}})]}),Object(b.jsx)(P,{isOpen:a,template:t,textFiles:n,close:function(){return o(!1)}}),Object(b.jsx)(z,{isOpen:h,answerYes:s,answerNo:function(){return O(!1)}})]})})},U=n(220),V=function(e){var t=e.isOpen,n=e.availableQuestions,s=e.updateQuestions,c=Object(i.useState)([]),r=Object(l.a)(c,2),a=r[0],o=r[1],d=Object(i.useState)([]),h=Object(l.a)(d,2),x=h[0],g=h[1];Object(i.useEffect)((function(){o(v(n))}),[n]);var v=function(e){return e.map((function(e){return{key:e._id,value:e._id,text:e.question}}))};return Object(b.jsxs)(f.a,{style:{padding:10},size:"tiny",open:t,children:[Object(b.jsx)(O.a,{as:"h4",content:"Selected Questions:"}),Object(b.jsx)(U.a,{placeholder:"Select questions for this text",fluid:!0,search:!0,selection:!0,multiple:!0,options:a,onChange:function(e,t){return g(t.value)}}),Object(b.jsx)(p.a,{ordered:!0,divided:!0,relaxed:!0,children:x.map((function(e){return Object(b.jsx)(u.a,{children:Object(b.jsx)(u.a.Description,{content:n.find((function(t){return t._id===e})).question})},e)}))}),Object(b.jsx)(m.a,{}),Object(b.jsx)(j.a,{floated:"right",content:"Save",onClick:function(){return s(x)}})]})},L=function(e){var t=e.isOpen,n=e.availableStyles,s=e.updateStyle,c=Object(i.useState)([]),r=Object(l.a)(c,2),a=r[0],o=r[1],d=Object(i.useState)(n[0]._id),h=Object(l.a)(d,2),x=h[0],p=h[1];Object(i.useEffect)((function(){o(m(n))}),[n]);var m=function(e){return e.map((function(e){return{key:e._id,value:e._id,text:"family: ".concat(e.fontFamily,", size: ").concat(e.fontSize,", line-height: ").concat(e.lineHeight)}}))};return Object(b.jsxs)(f.a,{style:{padding:10},size:"tiny",open:t,children:[Object(b.jsx)(O.a,{as:"h4",content:"Styles:"}),Object(b.jsx)(U.a,{placeholder:"Select a style for this text",fluid:!0,selection:!0,options:a,onChange:function(e,t){return p(t.value)}}),Object(b.jsx)(u.a,{style:{marginTop:10},children:Object(b.jsxs)(u.a.Content,{children:[Object(b.jsx)(u.a.Header,{as:"h5",content:"Selected Style:"}),Object(b.jsx)(u.a.Description,{content:"font-family: ".concat(n.find((function(e){return e._id===x})).fontFamily)}),Object(b.jsx)(u.a.Description,{content:"font-size: ".concat(n.find((function(e){return e._id===x})).fontSize)}),Object(b.jsx)(u.a.Description,{content:"line-height: ".concat(n.find((function(e){return e._id===x})).lineHeight)})]})}),Object(b.jsx)(j.a,{floated:"right",content:"Save",onClick:function(){return s(x)}})]})},Y=function(e){var t=e.text,n=e.availableQuestions,s=e.availableStyles,c=e.addQuestions,r=e.selectStyle,a=e.setInstructions,o=e.instructionsError,d=e.toggleHasFamiliarityQuestion,f=e.toggleHasInterestQuestion,h=Object(i.useState)(!1),O=Object(l.a)(h,2),x=O[0],p=O[1],m=Object(i.useState)(!1),v=Object(l.a)(m,2),y=v[0],S=v[1],I=Object(i.useState)(!0),D=Object(l.a)(I,2),w=D[0],k=D[1];return Object(b.jsx)(u.a,{children:Object(b.jsx)(u.a.Content,{children:Object(b.jsxs)("div",{className:"wrapper",children:[Object(b.jsx)("div",{children:Object(b.jsx)(u.a.Header,{style:{margin:5},content:t.fileName})}),Object(b.jsx)(g.a,{type:"text",error:o&&w,placeholder:"Write instructions here...",onChange:function(e){return function(e,t){k(""===t),a(e,t)}(t,e.target.value)}}),Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{className:"ui checkbox",children:[Object(b.jsx)("input",{type:"checkbox",defaultChecked:!0,onClick:d}),Object(b.jsx)("label",{children:"Ask user about their familiarity"})]}),Object(b.jsxs)("div",{className:"ui checkbox",children:[Object(b.jsx)("input",{type:"checkbox",defaultChecked:!0,onClick:f}),Object(b.jsx)("label",{children:"Ask user about their interest"})]})]}),Object(b.jsx)(j.a,{content:"Styles",onClick:function(){return S(!0)}}),Object(b.jsx)(j.a,{content:"Questions",onClick:function(){return p(!0)}}),Object(b.jsx)(V,{isOpen:x,availableQuestions:n,updateQuestions:function(e){p(!1),c(t,e)}}),Object(b.jsx)(L,{isOpen:y,availableStyles:s,updateStyle:function(e){S(!1),r(t,e)}})]})})},t.fileID)},B=function(e){var t=e.text,n=e.availableStyles,s=e.selectStyle,c=Object(i.useState)(!1),r=Object(l.a)(c,2),a=r[0],o=r[1];return Object(b.jsx)(u.a,{children:Object(b.jsx)(u.a.Content,{children:Object(b.jsxs)("div",{className:"wrapper",children:[Object(b.jsx)("div",{children:Object(b.jsx)(u.a.Header,{style:{margin:5},content:t.fileName})}),Object(b.jsx)(j.a,{content:"Styles",onClick:function(){return o(!0)}}),Object(b.jsx)(L,{isOpen:a,availableStyles:n,updateStyle:function(e){o(!1),s(t,e)}})]})})},t.fileID)},M=function(e){var t=e.isOpen,n=e.close,s=e.textFiles,c=Object(i.useState)(""),r=Object(l.a)(c,2),a=r[0],u=r[1],d=Object(i.useState)([]),h=Object(l.a)(d,2),x=h[0],m=h[1],v=Object(i.useState)(""),S=Object(l.a)(v,2),I=S[0],D=S[1],w=Object(i.useState)([]),k=Object(l.a)(w,2),T=k[0],N=k[1],F=Object(i.useState)(!1),E=Object(l.a)(F,2),q=E[0],A=E[1],_=Object(i.useState)([]),Q=Object(l.a)(_,2),H=Q[0],R=Q[1];Object(i.useEffect)((function(){R(P(s))}),[s]);var P=function(e){return e.map((function(e){return{key:e.key,value:e.value,text:e.name}}))},z=function(e,t){var n=T.indexOf(e),i=T;i[n].questionIDs=t,N(i)},J=function(e,t){var n=x.indexOf(e),i=x;i[n].styleID=t,m(i)},V=function(e,t){var n=T.indexOf(e),i=T;i[n].styleID=t,N(i)},L=function(e,t){var n=T.indexOf(e),i=T;i[n].instructions.main=t,N(i)},M=function(e,t){var n=T.indexOf(e),i=T;if("familiarity"===t){var s=!i[n].instructions.hasFamiliarityQuestion;i[n].instructions.hasFamiliarityQuestion=s}if("interest"===t){var c=!i[n].instructions.hasInterestQuestion;i[n].instructions.hasInterestQuestion=c}N(i)},W=function(e,t){if(u(""),m([]),N([]),D(""),A(!1),e){var i=[];t.speedTest.texts.forEach((function(e){i.push({fileID:e.fileID,name:s.find((function(t){return t.value===e.fileID})).name,styleID:e.styleID})}));var c=[];t.scrollTexts.forEach((function(e){return c.push({fileID:e.fileID,name:s.find((function(t){return t.value===e.fileID})).name,instructions:e.instructions,questionIDs:e.questionIDs,styleID:e.styleID})}));var r={key:t._id,name:t.name,speedTest:{texts:i,instructions:t.speedTest.instructions},scrollTexts:c,createdAt:t.createdAt,url:t._id};n(!0,r)}else n(!1,null)};return Object(b.jsx)("div",{children:Object(b.jsxs)(f.a,{open:t,style:{height:"70vh",padding:10},children:[Object(b.jsx)(O.a,{as:"h1",content:"Create a Session Template"}),Object(b.jsxs)(C.a,{style:{overflow:"auto",maxHeight:"75%"},children:[Object(b.jsxs)(C.a,{children:[Object(b.jsx)(O.a,{as:"h3",content:"Template Name:",style:{paddingTop:5,marginRight:10}}),Object(b.jsx)(g.a,{type:"text",error:""===a&&q,autoFocus:!0,fluid:!0,placeholder:"Type template name here...",onChange:function(e){return u(e.target.value)}})]}),Object(b.jsxs)(C.a,{children:[Object(b.jsx)(O.a,{as:"h3",content:"Speed Test Instructions:",style:{paddingTop:5,marginRight:10}}),Object(b.jsx)(g.a,{type:"text",error:""===I&&q,fluid:!0,placeholder:"Write instructions for the speed test here...",onChange:function(e){return D(e.target.value)}})]}),Object(b.jsxs)(C.a,{children:[Object(b.jsx)(O.a,{as:"h3",content:"Speed Texts:",style:{paddingTop:5,marginRight:10}}),Object(b.jsx)(U.a,{placeholder:"Select texts for the speed test",error:0===x.length&&q,fluid:!0,search:!0,selection:!0,multiple:!0,options:H,onChange:function(e,t){if("delete icon"===e.target.className)for(var n=function(e){if(-1===t.value.indexOf(t.options[e].value)&&x.some((function(n){return n.fileID===t.options[e].value})))return m(x.filter((function(n){return n.fileID!==t.options[e].value}))),"break"},i=0;i<t.options.length;i++){if("break"===n(i))break}else m([].concat(Object(o.a)(x),[{fileID:t.value[t.value.length-1],fileName:t.options.find((function(e){return e.value===t.value[t.value.length-1]})).text,styleID:s.find((function(e){return e.value===t.value[t.value.length-1]})).styles[0]._id}]))}}),Object(b.jsx)(p.a,{relaxed:!0,divided:!0,children:x.map((function(e){return Object(b.jsx)(B,{text:e,availableStyles:s.find((function(t){return t.key===e.fileID})).styles,selectStyle:J},e.fileID)}))})]}),Object(b.jsxs)(C.a,{children:[Object(b.jsx)(O.a,{as:"h3",content:"Scrollable Texts:",style:{paddingTop:5,marginRight:10}}),Object(b.jsx)(U.a,{placeholder:"Select texts for the scroll test",error:0===T.length&&q,fluid:!0,search:!0,selection:!0,multiple:!0,options:H,onChange:function(e,t){if("delete icon"===e.target.className)for(var n=function(e){if(-1===t.value.indexOf(t.options[e].value)&&T.some((function(n){return n.fileID===t.options[e].value})))return N(T.filter((function(n){return n.fileID!==t.options[e].value}))),"break"},i=0;i<t.options.length;i++){if("break"===n(i))break}else N([].concat(Object(o.a)(T),[{fileID:t.value[t.value.length-1],fileName:t.options.find((function(e){return e.value===t.value[t.value.length-1]})).text,instructions:{main:"",hasFamiliarityQuestion:!0,hasInterestQuestion:!0},questionIDs:[],styleID:s.find((function(e){return e.value===t.value[t.value.length-1]})).styles[0]._id}]))}}),Object(b.jsx)(p.a,{relaxed:!0,divided:!0,children:T.map((function(e){return Object(b.jsx)(Y,{text:e,availableQuestions:s.find((function(t){return t.key===e.fileID})).questions,availableStyles:s.find((function(t){return t.key===e.fileID})).styles,addQuestions:z,selectStyle:V,setInstructions:L,instructionsError:""===e.instructions.main&&q,toggleHasFamiliarityQuestion:function(){return M(e,"familiarity")},toggleHasInterestQuestion:function(){return M(e,"interest")}},e.fileID)}))})]})]}),Object(b.jsxs)("div",{style:{position:"absolute",right:10,bottom:10},children:[Object(b.jsx)(j.a,{content:"Cancel",onClick:function(){return W(!1,null)}}),Object(b.jsx)(j.a,{positive:!0,content:"Create",onClick:function(){if(!function(){var e=!1;""===a.trim()&&(A(!0),e=!0),0===x.length&&(A(!0),e=!0),0===T.length&&(A(!0),e=!0),""===I.trim()&&(A(!0),e=!0);for(var t=0;t<T.length;t++)if(""===T[t].instructions.main){A(!0),e=!0;break}return e}()){for(var e=[],t=0;t<T.length;t++)e.push({fileID:T[t].fileID,instructions:T[t].instructions,questionIDs:T[t].questionIDs,styleID:T[t].styleID});var n={name:a.trim(),speedTest:{texts:x,instructions:I.trim()},scrollTexts:e,createdAt:new Date};y.a.post("http://localhost:3001/createSessionTemplate",n).then((function(e){W(!0,e.data)})).catch((function(e){console.error("Error creating session template:",e)}))}}})]})]})})},W=function(e){var t=e.uploadSubmitted,n={fontFamily:"sans-serif",fontSize:15,lineHeight:20},s=Object(i.useRef)();return Object(b.jsxs)("div",{children:[Object(b.jsx)(j.a,{style:{position:"absolute",right:10},positive:!0,content:"Upload Text",icon:"file",onClick:function(){s.current.click()}}),Object(b.jsx)("input",{ref:s,type:"file",name:"file",accept:".txt",hidden:!0,onChange:function(e){var i=e.target.files[0];if("undefined"!==typeof i){var s=new FileReader;s.onload=function(e){var s={text:e.target.result,fileName:i.name,questions:[],questionFormat:"",styles:[n],createdAt:new Date};y.a.post("http://localhost:3001/uploadTextFile",s).then((function(e){var i={key:e.data._id,value:e.data._id,name:e.data.fileName,questions:[],questionFormat:"",styles:[n],uploadedAt:e.data.createdAt};t(i)})).catch((function(e){console.error("Error uploading text file:",e)}))},s.readAsText(i)}}})]})},K=n(14),X=n.n(K),G=n(25),Z=n(158),$=function(e){var t=e.isOpen,n=e.templates,s=e.textFiles,c=e.close,r=Object(i.useState)([]),a=Object(l.a)(r,2),o=a[0],u=a[1],d=Object(i.useState)(""),h=Object(l.a)(d,2),x=h[0],p=h[1];Object(i.useEffect)((function(){t&&m()}),[t]);var m=function(){y.a.get("http://localhost:3001/getReadingSessions").then((function(e){var t=e.data,i=[];t.forEach((function(e){i.push({key:e._id,value:e._id,text:"User: ".concat(e.userName,", Template: ").concat(n.find((function(t){return t.key===e.templateID})).name,", Start Time: ").concat(e.startTime)})})),u(i)})).catch((function(e){console.error("Error fetching ReadingSessions:",e)}))},g=function(){var e=Object(G.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",y.a.get("http://localhost:3001/getScrollPosEntries",{params:{sessionID:x}}).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(){var e=Object(G.a)(X.a.mark((function e(){return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",y.a.get("http://localhost:3001/getReadingSession",{params:{_id:x}}).then((function(e){return e.data})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(G.a)(X.a.mark((function e(t){var n,i,s,c,r,a;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=[],i=0,s=0,c=0;c<t.length;c++)i!==t[c].textNumber&&(n.push({textNumber:i,entries:t.slice(s,c)}),i=t[c].textNumber,s=c);for(n.push({textNumber:i,entries:t.slice(s)}),r=0;r<n.length;r++)a=k(n[r].entries),T(a,"scrollText_".concat(n[r].textNumber,"_positions"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=function(e,t){var n={userName:e.userName,startTime:e.startTime,endTime:e.endTime,templateName:t.name,speedTestInstructions:t.speedTest.instructions};T([n],"readingSession_".concat(e._id))},D=function(e,t){var n=JSON.parse(JSON.stringify(t.speedTest.texts)),i=0;n.forEach((function(t){var n=s.find((function(e){return e.key===t.fileID})).styles.find((function(e){return e._id===t.styleID})),c=e.speedTexts.find((function(e){return e.fileID===t.fileID}));t.startTime=c.startTime,t.endTime=c.endTime,t.fontFamily=n.fontFamily,t.fontSize=n.fontSize,t.lineHeight=n.lineHeight,delete t.styleID,T(c.pauses,"speedText_".concat(i,"_pauses")),i++})),T(n,"speedTexts")},w=function(e,t){var n=JSON.parse(JSON.stringify(t.scrollTexts)),i=0;n.forEach((function(t){var n=s.find((function(e){return e.key===t.fileID})),c=n.styles.find((function(e){return e._id===t.styleID})),r=e.scrollTexts.find((function(e){return e.fileID===t.fileID}));t.startTime=r.startTime,t.endTime=r.endTime,t.instructions=t.instructions.main,t.questionFormat=n.questionFormat,t.userFamiliarity=r.familiarity,t.userInterest=r.interest,t.fontFamily=c.fontFamily,t.fontSize=c.fontSize,t.lineHeight=c.lineHeight;var a=t.questionIDs;delete t.styleID,delete t.questionIDs,T(r.pauses,"scrollText_".concat(i,"_pauses"));for(var o=[],l=function(e){var t=r.questionAnswers[e],i=n.questions.find((function(t){return t._id===a[e]})),s="[".concat(i.answerRegion.startIndex,", ").concat(i.answerRegion.endIndex,"]");o.push({question:i.question,userAnswer:t.answer,correctAnswer:s,skip:t.skip,yPosition:t.yPosition,time:t.time})},u=0;u<r.questionAnswers.length;u++)l(u);T(o,"scrollText_".concat(i,"_questionAnswers")),i++})),T(n,"scrollTexts")},k=function(e){return e.map((function(e){return{yPos:e.yPos,time:e.time}}))},T=function(e,t){if(e.length>0){var n={filename:t,fieldSeparator:",",quoteStrings:'"',decimalSeparator:".",showLabels:!0,useBom:!0,useKeysAsHeaders:!0};new Z.ExportToCsv(n).generateCsv(e)}},C=function(){var e=Object(G.a)(X.a.mark((function e(){var t,i,s,c;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return t=e.sent,S(t),e.next=6,v();case 6:i=e.sent,s=n.find((function(e){return e.key===i.templateID})),r=i.viewportDimensions,c=r.map((function(e){return{width:e.width,height:e.height,time:e.time}})),T(c,"viewportDimensions"),I(i,s),D(i,s),w(i,s),N();case 14:case"end":return e.stop()}var r}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){u([]),p(""),c()};return Object(b.jsxs)(f.a,{open:t,style:{padding:10},children:[Object(b.jsx)(O.a,{as:"h2",content:"Select reading session to download",textAlign:"center"}),Object(b.jsx)(U.a,{placeholder:"Select Session",fluid:!0,search:!0,selection:!0,options:o,onChange:function(e,t){return p(t.value)}}),Object(b.jsxs)("div",{style:{float:"right",paddingTop:10},children:[Object(b.jsx)(j.a,{primary:!0,content:"Export Session Data",icon:"download",onClick:C}),Object(b.jsx)(j.a,{content:"Cancel",onClick:N})]})]})},ee=function(){var e=Object(i.useState)({data:[],isFetching:!0}),t=Object(l.a)(e,2),n=t[0],s=t[1],c=Object(i.useState)({data:[],isFetching:!0}),r=Object(l.a)(c,2),a=r[0],u=r[1],d=Object(i.useState)(!1),f=Object(l.a)(d,2),h=f[0],x=f[1],p=Object(i.useState)(!1),m=Object(l.a)(p,2),g=m[0],v=m[1];Object(i.useEffect)((function(){S()}),[]),Object(i.useEffect)((function(){n.isFetching||I()}),[n.isFetching]);var S=function(){s({data:n.data,isFetching:!0}),y.a.get("/api/getAllTextFiles").then((function(e){var t=e.data,n=[];t.forEach((function(e){var t={key:e._id,value:e._id,name:e.fileName,questions:e.questions,questionFormat:e.questionFormat,styles:e.styles,uploadedAt:e.createdAt};n.push(t)})),s({data:n,isFetching:!1})})).catch((function(e){console.error("Error fetching files:",e)}))},I=function(){u({data:a.data,isFetching:!0}),y.a.get("/api/getSessionTemplates").then((function(e){var t=[];e.data.forEach((function(e){var i=[];e.speedTest.texts.forEach((function(e){i.push({fileID:e.fileID,name:n.data.find((function(t){return t.value===e.fileID})).name,styleID:e.styleID})}));var s=[];e.scrollTexts.forEach((function(e){s.push({fileID:e.fileID,name:n.data.find((function(t){return t.value===e.fileID})).name,instructions:e.instructions,questionIDs:e.questionIDs,styleID:e.styleID})}));var c={key:e._id,name:e.name,speedTest:{texts:i,instructions:e.speedTest.instructions},scrollTexts:s,createdAt:e.createdAt,url:e._id};t.push(c)})),u({data:t,isFetching:!1})})).catch((function(e){console.error("Error fetching session templates:",e)}))},D=function(){x(!0)},w=function(e,t){e&&u({data:[].concat(Object(o.a)(a.data),[t]),isFetching:!1}),x(!1)},k=function(e){if(!a.isFetching){var t=void 0!==a.data.find((function(t){return t.speedTest.texts.some((function(t){return t.fileID===e}))})),n=T(e);return t||n}return!1},T=function(e){return!a.isFetching&&void 0!==a.data.find((function(t){return t.scrollTexts.some((function(t){return t.fileID===e}))}))},N=function(e){y.a.get("http://localhost:3001/getTextFile",{params:{_id:e.key}}).then((function(t){var i=e;i.styles[0]._id=t.data.styles[0]._id,s({data:[].concat(Object(o.a)(n.data),[i]),isFetching:!1})})).catch((function(e){console.error("Error fetching text in ScrollText:",e)}))};return Object(b.jsx)("div",{className:"researcher",children:Object(b.jsx)(H.a,{children:Object(b.jsxs)(R.a,{children:[Object(b.jsxs)(R.a.Row,{children:[Object(b.jsx)(R.a.Column,{width:8,children:function(){var e=window.location.href;if("/data"!==e.substr(e.length-5)&&!n.isFetching)return Object(b.jsxs)("div",{children:[Object(b.jsx)(O.a,{as:"h1",textAlign:"center",content:"Uploaded Texts"}),Object(b.jsx)(C.a,{style:{overflow:"auto",maxHeight:"75vh"},children:Object(b.jsx)("div",{className:"ui link divided relaxed items",children:n.data.map((function(e){return Object(b.jsx)(Q,{file:e,usedInTemplate:k(e.key),usedAsScrollText:T(e.key),updateFileQuestions:function(t,i){return function(e,t,i){var c=n.data,r=c.indexOf(e);c[r].questions.push(t),c[r].questionFormat=i,s({data:c,isFetching:!1})}(e,t,i)},removeQuestion:function(t){return function(e,t){var i=n.data,c=i.indexOf(e);i[c].questions=i[c].questions.filter((function(e){return e!==t}));var r=i[c].questions.length>0?i[c].questionFormat:"";i[c].questionFormat=r,s({data:i,isFetching:!1}),y.a.put("http://localhost:3001/removeTextFileQuestion",{fileID:e.key,questionID:t._id,questionFormat:r}).catch((function(e){console.error("Error removing question from file.questions",e)}))}(e,t)},updateFileStyles:function(t){return function(e,t){var i=n.data,c=i.indexOf(e);i[c].styles.push(t),s({data:i,isFetching:!1})}(e,t)},removeStyle:function(t){return function(e,t){var i=n.data,c=i.indexOf(e);i[c].styles=i[c].styles.filter((function(e){return e!==t})),s({data:i,isFetching:!1}),y.a.put("http://localhost:3001/removeTextFileStyle",{fileID:e.key,styleID:t._id}).catch((function(e){console.error("Error removing style from file.styles",e)}))}(e,t)},deleteFile:function(){return function(e){var t=n.data;t=t.filter((function(t){return t!==e})),s({data:t,isFetching:!1}),y.a.put("http://localhost:3001/deleteTextFile",{fileID:e.key}).catch((function(e){console.error("Error deleting file",e)}))}(e)}},e.key)}))})}),Object(b.jsx)(W,{uploadSubmitted:N})]})}()}),Object(b.jsx)(R.a.Column,{width:8,children:function(){var e=window.location.href;if("/data"!==e.substr(e.length-5)&&!a.isFetching)return Object(b.jsxs)("div",{children:[Object(b.jsx)(O.a,{as:"h1",textAlign:"center",content:"Existing Templates"}),Object(b.jsx)(C.a,{style:{overflow:"auto",maxHeight:"75vh"},children:Object(b.jsx)("div",{className:"ui link divided relaxed items",children:a.data.map((function(e){return Object(b.jsx)(J,{template:e,textFiles:n.data,deleteTemplate:function(){return function(e){var t=a.data;t=t.filter((function(t){return t!==e})),u({data:t,isFetching:!1}),y.a.put("http://localhost:3001/deleteTemplate",{templateID:e.key}).catch((function(e){console.error("Error deleting template",e)}))}(e)}},e.key)}))})}),Object(b.jsx)(j.a,{style:{position:"absolute",right:10},positive:!0,content:"Create Template",onClick:D}),Object(b.jsx)(M,{isOpen:h,close:w,textFiles:n.data})]})}()})]}),Object(b.jsxs)(R.a.Row,{children:[Object(b.jsx)(j.a,{positive:!0,content:"Download data",onClick:function(){return v(!0)}}),Object(b.jsx)($,{isOpen:g,templates:a.data,textFiles:n.data,close:function(){return v(!1)}})]})]})})})},te=n(38),ne=Object(i.createContext)(),ie=function(e){var t=e.children,n=Object(i.useState)(JSON.parse(localStorage.getItem("sessionTemplate"))),s=Object(l.a)(n,2),c=s[0],r=s[1],a=Object(i.useState)(JSON.parse(localStorage.getItem("isPaused"))),o=Object(l.a)(a,2),u=o[0],d=o[1],j=Object(i.useState)(JSON.parse(localStorage.getItem("hasStartedReading"))),f=Object(l.a)(j,2),h=f[0],O=f[1],x=Object(i.useState)(JSON.parse(localStorage.getItem("fileNumber"))),p=Object(l.a)(x,2),m=p[0],g=p[1],v=Object(i.useState)(JSON.parse(localStorage.getItem("scrollPosEntries"))),y=Object(l.a)(v,2),S=y[0],I=y[1],D=Object(i.useState)(localStorage.getItem("questionFormat")),w=Object(l.a)(D,2),k=w[0],T=w[1],C=Object(i.useState)(JSON.parse(localStorage.getItem("questionAnswers"))),N=Object(l.a)(C,2),F=N[0],E=N[1],q=Object(i.useState)(localStorage.getItem("sessionID")),A=Object(l.a)(q,2),_=A[0],Q=A[1];Object(i.useEffect)((function(){null===JSON.parse(localStorage.getItem("isPaused"))&&H()}),[]);var H=function(){r(null),d(!1),O(!1),g(0),I([]),T(""),E([]),Q("")};return Object(i.useEffect)((function(){localStorage.setItem("sessionTemplate",JSON.stringify(c))}),[c]),Object(i.useEffect)((function(){localStorage.setItem("isPaused",JSON.stringify(u))}),[u]),Object(i.useEffect)((function(){localStorage.setItem("hasStartedReading",JSON.stringify(h))}),[h]),Object(i.useEffect)((function(){localStorage.setItem("fileNumber",JSON.stringify(m))}),[m]),Object(i.useEffect)((function(){localStorage.setItem("scrollPosEntries",JSON.stringify(S))}),[S]),Object(i.useEffect)((function(){localStorage.setItem("questionFormat",k)}),[k]),Object(i.useEffect)((function(){localStorage.setItem("questionAnswers",JSON.stringify(F))}),[F]),Object(i.useEffect)((function(){localStorage.setItem("sessionID",_)}),[_]),Object(b.jsx)(ne.Provider,{value:{template:c,setTemplate:r,isPaused:u,setIsPaused:d,hasStartedReading:h,setHasStartedReading:O,fileNumber:m,setFileNumber:g,scrollPosEntries:S,setScrollPosEntries:I,questionFormat:k,setQuestionFormat:T,questionAnswers:F,setQuestionAnswers:E,sessionID:_,setSessionID:Q,initialiseVariables:H},children:t})},se=function(){return Object(b.jsxs)("div",{children:[Object(b.jsx)(O.a,{as:"h1",content:"404 Error!"}),Object(b.jsx)(C.a,{children:Object(b.jsx)("p",{style:{color:"red"},children:"The url for this page is invalid."})})]})},ce=function(){var e=Object(i.useState)(""),t=Object(l.a)(e,2),n=t[0],s=t[1],c=Object(i.useState)(null),r=Object(l.a)(c,2),a=r[0],o=r[1],u=Object(i.useState)(!1),d=Object(l.a)(u,2),f=d[0],h=d[1],O=Object(i.useState)(!1),x=Object(l.a)(O,2),p=x[0],m=x[1],v=Object(i.useContext)(ne),S=Object(i.createRef)(),I=Object(i.createRef)(),D=Object(i.createRef)();Object(i.useEffect)((function(){w()}),[]);var w=function(){var e=window.location.href.toString(),t=e.substr(e.lastIndexOf("/")+1);y.a.get("http://localhost:3001/getSessionTemplate",{params:{_id:t}}).then((function(e){"CastError"===e.data.name?h(!0):o(e.data)})).catch((function(e){console.error("Error fetching SessionTemplate:",e)}))},k=function(){var e=Object(G.a)(X.a.mark((function e(){var t,i,s,c,r;return X.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=!1,i=new Date,s=window.innerWidth,c=window.innerHeight,r={userName:n.trim(),viewportDimensions:[{width:s,height:c,time:i}],templateID:a._id,startTime:i},e.next=7,y.a.post("http://localhost:3001/createReadingSession",r).then((function(e){v.setSessionID(e.data._id),t=!0})).catch((function(e){console.error("Error adding session:",e)}));case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){""!==n.trim()?k()&&(v.setTemplate(a),S.current.click()):m(!0)},N=function(){y.a.get("http://localhost:3001/getReadingSession",{params:{_id:v.sessionID}}).then((function(e){var t=e.data;t.scrollTexts.length===a.scrollTexts.length&&t.scrollTexts.at(-1).hasOwnProperty("endTime")?D.current.click():t.scrollTexts.length>0?I.current.click():S.current.click()}))},F=function(e){m(!1),s(e.target.value)},E=function(){if(p)return Object(b.jsx)("label",{style:{padding:10,float:"right",color:"red"},children:"Please enter a username!"})};return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{children:f?Object(b.jsx)(se,{}):""===v.sessionID?Object(b.jsx)("div",{style:{textAlign:"center"},children:Object(b.jsxs)(H.a,{text:!0,children:[Object(b.jsx)("h1",{children:"Welcome!"}),Object(b.jsx)(C.a,{children:"Please type your name below, and click on the button to begin the session!"}),Object(b.jsxs)("div",{className:"wrapper",style:{justifyContent:"center"},children:[Object(b.jsx)(g.a,{type:"text",placeholder:"Type your name here...",onChange:F}),Object(b.jsx)(j.a,{primary:!0,content:"Start Task 1",onClick:T}),E()]})]})}):Object(b.jsx)("div",{style:{textAlign:"center"},children:Object(b.jsxs)(H.a,{text:!0,children:[Object(b.jsx)(C.a,{children:"You are currently in an active session, Click the button to resume!"}),Object(b.jsx)(j.a,{primary:!0,content:"Resume Session",onClick:N})]})})}),Object(b.jsx)(te.b,{to:"/speedtest",hidden:!0,ref:S}),Object(b.jsx)(te.b,{to:"/scrolltest",hidden:!0,ref:I}),Object(b.jsx)(te.b,{to:"/end",hidden:!0,ref:D})]})},re=function(e){var t=e.fileID,n=e.textStyleID,s=Object(i.useState)(""),c=Object(l.a)(s,2),r=c[0],a=c[1],o=Object(i.useState)(null),u=Object(l.a)(o,2),d=u[0],j=u[1];Object(i.useEffect)((function(){f()}),[t]);var f=function(){y.a.get("http://localhost:3001/getTextFile",{params:{_id:t}}).then((function(e){a(e.data.text);var t=e.data.styles.find((function(e){return e._id===n}));j({fontFamily:t.fontFamily,fontSize:"".concat(t.fontSize,"px"),lineHeight:"".concat(t.lineHeight,"px")})})).catch((function(e){console.error("Error fetching text in SpeedText:",e)}))};return Object(b.jsx)(H.a,{text:!0,style:d,children:r})},ae=n(221),oe=function(e){var t=e.isOpen,n=e.instructions,s=e.fileID,c=Object(i.useContext)(ne);return Object(b.jsxs)(f.a,{size:"tiny",open:t,style:{overflow:"auto",padding:10},children:[Object(b.jsx)(f.a.Description,{as:"h4",content:n}),Object(b.jsx)(j.a,{floated:"right",primary:!0,content:"Begin",onClick:function(){var e=c.sessionID,t=new Date;y.a.put("http://localhost:3001/addNewSpeedText",{id:e,fileID:s,startTime:t}).then((function(){c.setHasStartedReading(!0)})).catch((function(e){console.error("Error updating readingSession.speedTest.startTime:",e)}))}})]})},le=function(e){var t=e.isOpen,n=e.resume;return Object(b.jsxs)(f.a,{size:"tiny",open:t,style:{textAlign:"center",padding:10},children:[Object(b.jsx)(f.a.Header,{as:"h4",children:"Click to resume reading."}),Object(b.jsx)(j.a,{primary:!0,content:"Reume",onClick:n})]})},ue=n(122),de=function(){var e=Object(i.useContext)(ne),t=Object(i.createRef)(),n=Object(i.useState)(""),s=Object(l.a)(n,2),c=s[0],r=s[1],a=Object(i.useState)(e.template.speedTest.texts[e.fileNumber]),o=Object(l.a)(a,2),u=o[0],d=o[1],f=Object(i.useState)(!1),h=Object(l.a)(f,2),O=h[0],x=h[1];Object(i.useEffect)((function(){r(e.template.speedTest.instructions),p(),window.onresize=Object(ue.debounce)((function(t){return k(0,e)}),500)}),[]),Object(i.useEffect)((function(){d(e.template.speedTest.texts[e.fileNumber])}),[e.fileNumber]);var p=function(){y.a.get("http://localhost:3001/getReadingSession",{params:{_id:e.sessionID}}).then((function(e){var t=e.data;if(t.hasOwnProperty("speedTexts")){var n=t.speedTexts.find((function(e){return e.fileID===u.fileID}));"undefined"!==typeof n&&x(n.hasOwnProperty("endTime"))}}))},m=function(t){var n=e.sessionID,i=new Date;y.a.put("http://localhost:3001/addNewSpeedText",{id:n,fileID:t,startTime:i}).catch((function(e){console.error("Error adding new text to readingSession.speedTexts:",e)}))},g=function(){var t=Object(G.a)(X.a.mark((function t(){var n,i,s;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=!1,i=e.sessionID,s=new Date,y.a.put("http://localhost:3001/updateCurrentSpeedText",{id:i,fileID:u.fileID,endTime:s}).then((function(){n=!0})).catch((function(e){console.error("Error updating readingSession.speedTexts[currentFileID].endTime:",e)})),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),v=function(){var n=Object(G.a)(X.a.mark((function n(){var i,s;return X.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=g(),s=e.fileNumber,i&&(D("speed",e)?(e.setFileNumber(0),e.setHasStartedReading(!1),t.current.click()):(m(e.template.speedTest.texts[s+1].fileID),e.setFileNumber(s+1),w()));case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),S=function(){var t=Object(G.a)(X.a.mark((function t(n){var i,s,c;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.sessionID,s=new Date,c=n?"pause":"resume",y.a.put("http://localhost:3001/updateCurrentSpeedTextPauses",{id:i,fileID:u.fileID,action:c,time:s}).catch((function(e){console.error("Error updating readingSession.speedTexts[fileID].pauses",e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{style:{top:0,left:0,width:"15vw",position:"fixed"},children:Object(b.jsxs)(ae.a,{vertical:!0,fluid:!0,style:{textAlign:"center"},children:[Object(b.jsx)(ae.a.Item,{children:Object(b.jsx)(j.a,{primary:!0,fluid:!0,disabled:O,content:"Done",onClick:v})}),Object(b.jsx)(te.b,{to:"/scrolltest",hidden:!0,ref:t}),Object(b.jsx)(ae.a.Item,{children:Object(b.jsx)(j.a,{negative:!0,fluid:!0,disabled:O,content:"Pause",onClick:function(){return S(!0),void e.setIsPaused(!0)}})})]})}),function(){if(e.hasStartedReading)return Object(b.jsx)(re,{fileID:u.fileID,textStyleID:u.styleID})}(),Object(b.jsx)(oe,{isOpen:!1===e.hasStartedReading,instructions:c,fileID:u.fileID}),Object(b.jsx)(le,{isOpen:e.isPaused,resume:function(){S(!1),e.setIsPaused(!1)}})]})},je=function(){return Object(b.jsx)("div",{style:{textAlign:"center"},children:Object(b.jsx)(H.a,{text:!0,children:Object(b.jsx)("h1",{children:"Session has been completed!"})})})},fe=function(){var e=Object(i.useContext)(ne),t=Object(i.useState)(null),n=Object(l.a)(t,2),s=n[0],c=n[1];Object(i.useEffect)((function(){c(null===e.sessionID||""===e.sessionID)}),[e.sessionID]);return!0===s?Object(b.jsx)(je,{}):!1===s?Object(b.jsx)(de,{}):Object(b.jsx)("div",{})},be=function(){var e=Object(i.useContext)(ne),t=Object(i.useState)(!1),n=Object(l.a)(t,2),s=n[0],c=n[1];Object(i.useEffect)((function(){s||(r(),e.initialiseVariables(!0),c(!0))}),[e]);var r=function(){localStorage.removeItem("userName"),localStorage.removeItem("scrollQuestionNumber")};return Object(b.jsx)("div",{style:{textAlign:"center"},children:Object(b.jsx)(C.a,{children:Object(b.jsx)(H.a,{text:!0,children:Object(b.jsx)(O.a,{as:"h1",content:"Thank you for taking the test!"})})})})},he="undefined"!==typeof window,Oe=function(){return he?{x:window.scrollX,y:window.scrollY}:{x:0,y:0}},xe=function(e,t){var n=null,s=function(){var t=Oe();e(t),n=null};Object(i.useLayoutEffect)((function(){var e=function(){t?null===n&&setTimeout(s,t):s()};return window.addEventListener("scroll",e),function(){return window.removeEventListener("scroll",e)}}))},pe=function(e){var t=e.fileID,n=e.textStyleID,s=e.selectAnswerEnabled,c=e.selectAnswer,r=Object(i.useContext)(ne),a=Object(i.useState)([]),o=Object(l.a)(a,2),u=o[0],d=o[1],j=Object(i.useState)(null),f=Object(l.a)(j,2),h=f[0],O=f[1];Object(i.useEffect)((function(){x()}),[t]);var x=function(){y.a.get("http://localhost:3001/getTextFile",{params:{_id:t}}).then((function(e){d(e.data.text.split(I));var t=e.data.styles.find((function(e){return e._id===n}));O({fontFamily:t.fontFamily,fontSize:"".concat(t.fontSize,"px"),lineHeight:"".concat(t.lineHeight,"px")}),r.setQuestionFormat(e.data.questionFormat),r.setQuestionAnswers(e.data.questions.map((function(e){return e.answerRegion})))})).catch((function(e){console.error("Error fetching text in ScrollText:",e)}))};Object(i.useEffect)((function(){var e=setInterval((function(){var e=r.scrollPosEntries;e.length>0&&(r.setScrollPosEntries([]),y.a.post("http://localhost:3001/insertScrollPosEntries",e).catch((function(e){console.error("Error adding scrollPosEntry:",e)})))}),500);return function(){return clearInterval(e)}}),[r.scrollPosEntries]);xe((function(e){!1===r.isPaused&&T(r,parseInt(e.y))}),25);return Object(b.jsx)(H.a,{text:!0,className:s?"hand-cursor":"",style:h,children:u.map((function(e,t){return Object(b.jsx)("span",{onClick:function(){return function(e){s&&c(e,!1)}(t)},children:e+" "},Object(S.a)())}))})},me=function(e){var t=e.isOpen,n=e.text,s=e.close,c=Object(i.useContext)(ne),r=Object(i.useState)("Very Unfamiliar"),a=Object(l.a)(r,2),o=a[0],u=a[1],d=Object(i.useState)("Very Uninterested"),h=Object(l.a)(d,2),O=h[0],x=h[1],p=function(){u("Very Unfamiliar"),x("Very Uninterested")};return Object(b.jsxs)(f.a,{size:"tiny",open:t,style:{textAlign:"center",overflow:"auto",padding:10},children:[Object(b.jsx)(f.a.Description,{as:"h4",content:n.instructions.main}),function(){if(!0===JSON.parse(n.instructions.hasFamiliarityQuestion))return Object(b.jsxs)("div",{className:"ui form",style:{textAlign:"center"},children:[Object(b.jsx)("label",{children:"How familiar are you with this topic?"}),Object(b.jsxs)("div",{className:"inline fields",children:[Object(b.jsx)("div",{className:"field",children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",checked:"Very Unfamiliar"===o,onChange:function(e){return u("Very Unfamiliar")}}),Object(b.jsx)("label",{children:"Very Unfamiliar"})]})}),Object(b.jsx)("div",{className:"field",children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",checked:"Unfamiliar"===o,onChange:function(e){return u("Unfamiliar")}}),Object(b.jsx)("label",{children:"Unfamiliar"})]})}),Object(b.jsx)("div",{className:"field",children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",checked:"Neutral"===o,onChange:function(e){return u("Neutral")}}),Object(b.jsx)("label",{children:"Neutral"})]})}),Object(b.jsx)("div",{className:"field",children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",checked:"Familiar"===o,onChange:function(e){return u("Familiar")}}),Object(b.jsx)("label",{children:"Familiar"})]})}),Object(b.jsx)("div",{className:"field",children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",checked:"Very Familiar"===o,onChange:function(e){return u("Very Familiar")}}),Object(b.jsx)("label",{children:"Very Familiar"})]})})]})]})}(),function(){if(!0===JSON.parse(n.instructions.hasInterestQuestion))return Object(b.jsxs)("div",{className:"ui form",children:[Object(b.jsx)("label",{children:"How interested are you with this topic?"}),Object(b.jsxs)("div",{className:"inline fields",children:[Object(b.jsx)("div",{className:"field",children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",checked:"Very Uninterested"===O,onChange:function(e){return x("Very Uninterested")}}),Object(b.jsx)("label",{children:"Very Uninterested"})]})}),Object(b.jsx)("div",{className:"field",children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",checked:"Uninterested"===O,onChange:function(e){return x("Uninterested")}}),Object(b.jsx)("label",{children:"Uninterested"})]})}),Object(b.jsx)("div",{className:"field",children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",checked:"Neutral"===O,onChange:function(e){return x("Neutral")}}),Object(b.jsx)("label",{children:"Neutral"})]})}),Object(b.jsx)("div",{className:"field",children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",checked:"Interested"===O,onChange:function(e){return x("Interested")}}),Object(b.jsx)("label",{children:"Interested"})]})}),Object(b.jsx)("div",{className:"field",children:Object(b.jsxs)("div",{className:"ui radio checkbox",children:[Object(b.jsx)("input",{type:"radio",checked:"Very Interested"===O,onChange:function(e){return x("Very Interested")}}),Object(b.jsx)("label",{children:"Very Interested"})]})})]})]})}(),Object(b.jsx)(j.a,{floated:"right",primary:!0,content:"Begin",onClick:function(){var e=c.sessionID,t=new Date,i={id:e,fileID:n.fileID,startTime:t};!0===JSON.parse(n.instructions.hasFamiliarityQuestion)&&(i.familiarity=o),!0===JSON.parse(n.instructions.hasInterestQuestion)&&(i.interest=O),y.a.put("http://localhost:3001/addNewScrollText",i).then((function(){p(),s()})).catch((function(e){console.error("Error updating readingSession.scrollTexts[text.fileID].startTime:",e)}))}})]})},ge=n(227),ve=n(217),ye=function(e){var t=e.currentText,n=e.questionNumber,s=e.disable,c=e.submitAnswer,r=e.skip,a=Object(i.useState)(""),o=Object(l.a)(a,2),u=o[0],d=o[1],f=Object(i.useState)(""),h=Object(l.a)(f,2),O=h[0],p=h[1];Object(i.useEffect)((function(){var e=t.fileID,i=t.questionIDs[n];y.a.get("http://localhost:3001/getTextFile",{params:{_id:e}}).then((function(e){var t=e.data.questions.find((function(e){return e._id===i}));"undefined"!==typeof t&&d(t.question)})).catch((function(e){console.error("Error fetching text in ScrollText:",e)}))}),[t,n]);return Object(b.jsx)(ge.a,{fluid:!0,children:Object(b.jsxs)(ge.a.Content,{children:[Object(b.jsx)(ge.a.Header,{content:"Question:"}),Object(b.jsx)(ge.a.Description,{content:u}),Object(b.jsx)(x.a,{style:{marginTop:10,marginBottom:10},children:Object(b.jsx)(x.a.Field,{children:Object(b.jsx)(ve.a,{placeholder:"Type your answer here...",value:O,onChange:function(e){p(e.target.value)}})})}),Object(b.jsxs)(R.a,{children:[Object(b.jsx)(R.a.Column,{width:"8",children:Object(b.jsx)(j.a,{fluid:!0,primary:!0,disabled:s||""===O,content:"Submit",onClick:function(){c(O,!1),p("")}})}),Object(b.jsx)(R.a.Column,{width:"8",children:Object(b.jsx)(j.a,{fluid:!0,negative:!0,disabled:s,content:"Skip",onClick:function(){r(),p("")}})})]})]})})},Se=n(223),Ie=n(228),De=function(e){var t=e.currentText,n=e.questionNumber,s=e.disable,c=e.answerIsEnabled,r=e.enableAnswer,a=e.skip,o=Object(i.useState)(""),u=Object(l.a)(o,2),d=u[0],f=u[1];return Object(i.useEffect)((function(){var e=t.fileID,i=t.questionIDs[n];y.a.get("http://localhost:3001/getTextFile",{params:{_id:e}}).then((function(e){var t=e.data.questions.find((function(e){return e._id===i}));"undefined"!==typeof t&&f(t.question)})).catch((function(e){console.error("Error fetching text in ScrollText:",e)}))}),[t,n]),Object(b.jsx)(ge.a,{fluid:!0,children:Object(b.jsxs)(ge.a.Content,{children:[Object(b.jsx)(ge.a.Header,{content:"Question:"}),Object(b.jsx)(ge.a.Description,{style:{marginBottom:10},content:d}),Object(b.jsxs)(R.a,{children:[Object(b.jsx)(R.a.Column,{width:"8",children:Object(b.jsx)(j.a,{fluid:!0,basic:!c,positive:!0,disabled:s,content:"Answer",onClick:r})}),Object(b.jsx)(R.a.Column,{width:"8",children:Object(b.jsx)(j.a,{fluid:!0,negative:!0,disabled:s,content:"Skip",onClick:a})})]}),Object(b.jsx)(Se.a,{visible:c,animation:"glow",duration:2e3,children:Object(b.jsx)(Ie.a,{info:!0,hidden:!c,content:"Click in the text where you think the answer is!"})})]})})},we=function(e){var t=e.isOpen,n=e.skip,i=e.cancel;return Object(b.jsxs)(f.a,{size:"tiny",open:t,style:{textAlign:"center",padding:10},children:[Object(b.jsxs)(f.a.Header,{as:"h4",children:["Are you sure you want to skip this question?",Object(b.jsx)("br",{}),"You will not be able to come back to it later."]}),Object(b.jsx)(j.a,{primary:!0,content:"Yes",onClick:n}),Object(b.jsx)(j.a,{content:"No",onClick:i})]})},ke=function(e){var t=e.isOpen,n=e.close;return Object(b.jsxs)(f.a,{size:"tiny",open:t,style:{textAlign:"center",padding:10},children:[Object(b.jsxs)(f.a.Header,{as:"h4",children:["You have not answered all the questions for this text.",Object(b.jsx)("br",{}),'Please answer each of the remaining questions, or click "Skip"']}),Object(b.jsx)(j.a,{primary:!0,content:"Ok",onClick:n})]})},Te=function(e){var t=e.isOpen,n=e.isCorrect,i=e.tryAgain,s=e.continueReading,c=n?"Correct Answer!":"Your answer is incorrect";return Object(b.jsxs)(f.a,{size:"tiny",open:t,style:{textAlign:"center",padding:10},children:[Object(b.jsx)(f.a.Header,{as:"h4",children:c}),n?Object(b.jsx)(j.a,{floated:"right",content:"Ok",onClick:s}):Object(b.jsxs)("div",{children:[Object(b.jsx)(j.a,{floated:"right",primary:!0,content:"Try Again",onClick:i}),Object(b.jsx)(j.a,{floated:"right",content:"Continue Reading",onClick:s})]})]})},Ce=function(){var e=Object(i.useContext)(ne),t=Object(i.createRef)(),n=Object(i.useState)(e.template.scrollTexts[e.fileNumber]),s=Object(l.a)(n,2),c=s[0],r=s[1],a=Object(i.useState)(JSON.parse(localStorage.getItem("scrollQuestionNumber"))),o=Object(l.a)(a,2),u=o[0],d=o[1],f=Object(i.useState)(!1),h=Object(l.a)(f,2),O=h[0],x=h[1],p=Object(i.useState)({display:!1,isCorrect:!1}),m=Object(l.a)(p,2),g=m[0],v=m[1],S=Object(i.useState)(!1),I=Object(l.a)(S,2),C=I[0],N=I[1],F=Object(i.useState)(!1),E=Object(l.a)(F,2),q=E[0],A=E[1],_=Object(i.useState)(!1),Q=Object(l.a)(_,2),H=Q[0],R=Q[1];Object(i.useEffect)((function(){null===localStorage.getItem("scrollQuestionNumber")&&d(0),P(),window.onresize=Object(ue.debounce)((function(t){return k(0,e)}),500)}),[]),Object(i.useEffect)((function(){localStorage.setItem("scrollQuestionNumber",JSON.stringify(u))}),[u]),Object(i.useEffect)((function(){r(e.template.scrollTexts[e.fileNumber])}),[e.fileNumber]);var P=function(){y.a.get("http://localhost:3001/getReadingSession",{params:{_id:e.sessionID}}).then((function(e){var t=e.data;if(t.hasOwnProperty("scrollTexts")){var n=t.scrollTexts.find((function(e){return e.fileID===c.fileID}));"undefined"!==typeof n&&R(n.hasOwnProperty("endTime"))}}))},z=function(){var t=Object(G.a)(X.a.mark((function t(){var n,i;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.sessionID,i=new Date,y.a.put("http://localhost:3001/updateCurrentScrollText",{id:n,fileID:c.fileID,endTime:i}).catch((function(e){console.error("Error updating readingSession.scrollTexts[currentText.fileID].endTime:",e)})),t.abrupt("return",i);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),J=function(){var t=Object(G.a)(X.a.mark((function t(n){var i;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.sessionID,y.a.put("http://localhost:3001/addEndTime",{id:i,time:n}).catch((function(e){console.error("Error updating readingSession.endTime:",e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),U=function(){var n=Object(G.a)(X.a.mark((function n(){var i,s;return X.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(u<c.questionIDs.length)){n.next=4;break}A(!0),n.next=18;break;case 4:return n.next=6,z();case 6:if(i=n.sent,s=e.fileNumber,!D("scroll",e)){n.next=14;break}return n.next=11,J(i);case 11:t.current.click(),n.next=18;break;case 14:d(0),e.setFileNumber(s+1),w(),e.setHasStartedReading(!1);case 18:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),V=function(){var t=Object(G.a)(X.a.mark((function t(n){var i,s,r;return X.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e.sessionID,s=new Date,r=n?"pause":"resume",y.a.put("http://localhost:3001/updateCurrentScrollTextPauses",{id:i,fileID:c.fileID,action:r,time:s}).catch((function(e){console.error("Error updating readingSession.scrollTexts[fileID].pauses",e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),L=function(t,n){var i="inline"===e.questionFormat,s=e.sessionID,r=new Date,a=parseInt(Oe().y);y.a.put("http://localhost:3001/addCurrentScrollTextQuestionAnswer",{sessionID:s,fileID:c.fileID,answer:t,skip:n,yPos:a,time:r}).then((function(){if(i){var s=!1;e.questionAnswers[u].startIndex<=t&&t<=e.questionAnswers[u].endIndex&&(d(u+1),s=!0),n?d(u+1):v({display:!0,isCorrect:s})}else d(u+1)})).catch((function(e){console.error("Error updating readingSession.scrollTexts[fileID].questionAnswers",e)}))};return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{style:{top:0,left:0,width:"15vw",position:"fixed"},children:Object(b.jsxs)(ae.a,{vertical:!0,fluid:!0,style:{textAlign:"center"},children:[Object(b.jsx)(ae.a.Item,{children:Object(b.jsx)(j.a,{primary:!0,fluid:!0,disabled:H,content:"Done",onClick:U})}),Object(b.jsx)(te.b,{to:"/end",hidden:!0,ref:t}),Object(b.jsx)(ae.a.Item,{children:Object(b.jsx)(j.a,{negative:!0,fluid:!0,disabled:H,content:"Pause",onClick:function(){return V(!0),void e.setIsPaused(!0)}})})]})}),function(){if(e.hasStartedReading)return Object(b.jsx)(pe,{fileID:c.fileID,textStyleID:c.styleID,selectAnswerEnabled:O,selectAnswer:L})}(),function(){if(u<c.questionIDs.length)return Object(b.jsx)("div",{style:{top:"0px",right:"0px",width:"15vw",position:"fixed"},children:"comprehension"===e.questionFormat?Object(b.jsx)(ye,{currentText:c,questionNumber:u,disable:H,submitAnswer:L,skip:function(){return N(!0)}}):Object(b.jsx)(De,{currentText:c,questionNumber:u,disable:H,answerIsEnabled:O,enableAnswer:function(){return x(!O)},skip:function(){return N(!0)}})})}(),Object(b.jsx)(Te,{isOpen:g.display,isCorrect:g.isCorrect,tryAgain:function(){return v({display:!1,isCorrect:!1})},continueReading:function(){v({display:!1,isCorrect:!1}),x(!1)}}),Object(b.jsx)(we,{isOpen:C,skip:function(){L("",!0),x(!1),N(!1)},cancel:function(){return N(!1)}}),Object(b.jsx)(ke,{isOpen:q,close:function(){return A(!1)}}),Object(b.jsx)(me,{isOpen:!1===e.hasStartedReading,text:c,close:function(){e.setHasStartedReading(!0),T(e,parseInt(Oe().y))}}),Object(b.jsx)(le,{isOpen:e.isPaused,resume:function(){V(!1),e.setIsPaused(!1)}})]})},Ne=function(){var e=Object(i.useContext)(ne),t=Object(i.useState)(null),n=Object(l.a)(t,2),s=n[0],c=n[1];Object(i.useEffect)((function(){c(null===e.sessionID||""===e.sessionID)}),[e.sessionID]);return!0===s?Object(b.jsx)(je,{}):!1===s?Object(b.jsx)(Ce,{}):Object(b.jsx)("div",{})},Fe=function(){return Object(b.jsxs)("div",{children:[Object(b.jsx)(a.a,{path:"/researcher",component:ee}),Object(b.jsxs)(ie,{children:[Object(b.jsx)(a.a,{path:"/user",component:ce}),Object(b.jsx)(a.a,{path:"/speedtest",component:fe}),Object(b.jsx)(a.a,{path:"/scrolltest",component:Ne}),Object(b.jsx)(a.a,{path:"/end",component:be})]})]})};n(202);r.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(te.a,{children:Object(b.jsx)(Fe,{})})}),document.getElementById("root"))}},[[203,1,2]]]);
//# sourceMappingURL=main.fa3b5056.chunk.js.map